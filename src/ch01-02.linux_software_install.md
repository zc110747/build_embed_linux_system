# linux_software_install

## 综述

Linux根据不同平台支持不同的安装命令，如debian系的apt-get，centos的yum，本系列因为使用ubuntu系统属于debian，因此都使用apt/apt-get作为安装命令，对于打包好的文件安装包，可以使用dkpg进行安装。这里先列出安装的常用命令。

```shell
########################## apt,apt-get #################
#从软件源更新list
sudo apt-get update

#从软件源升级软件
sudo apt-get upgrade

#安装软件
sudo apt-get install [package]

#移除软件
sudo apt-get purge [package]

#检查没有依赖会自己删除
sudo apt-get autoremove

#查询已经安装的软件列表
sudo apt --installed list

#查询软件包, 支持通配
apt search [package]
apt --names-only search [package]

########################## dpkg ###########################
#安装linux环境包
sudo dpkg -i *.deb
```

## software_install

常用工具安装的列表如下

- [openssh工具安装](#openssh_install)
- [tftp服务安装](#tftp_install)
- [nfs服务安装](#nfs_install)
- [vscode软件安装](#vscode_install)
- [node环境安装](#node_install)
- [python安装和模块下载](#python_install)

本小节主要列出常用的工具指导，如远程访问的ssh，用于程序开发的vscode，这一类软件可以通过命令或者编译好的软件直接安装，相对来说比较简单，所以这里统一说明。

### openssh_install

- [software_install](#software_install)

对于ubuntu平台，可直接执行如下安装和运行.

```shell
sudo apt-get install openssh-server
sudo service ssh restart
```

远程可通过如下命令登录和传输文件

```shell
ssh [用户名]@[ipAddress]
scp -r [file] [用户名]@[ipAddress]:[directory]
```

如ssh freedom@192.168.0.99登录，不过默认不支持密码登录，需要在服务器/etc/ssh/sshd_config中，打开密码登录选：**PasswordAuthentication yes**。此外，还要指定连接的加密算法, 在ssh_config的文件末尾添加如下即可.

```shell
Ciphers aes128-cbc
MACs  hmac-md5
KexAlgorithms diffie-hellman-group1-sha1,ecdh-sha2-nistp256
```

分别添加服务端文件:**/etc/ssh/sshd_config**和客户端文件:**/etc/ssh/ssh_config**中, 如果linux访问远端显示MACs，Key不支持，也可以按照上述方法在文件里添加即可。当然对于windows系统，添加在文件:**C:\ProgramData\ssh\ssh_config**中(不存在则直接创建), 需要Windows管理员权限。另外如果ssh客户/服务端发生变化，如系统重装，导致命令字和服务端保存不一致，可通过如下命令清除。

```shell
ssh-keygen -f "/root/.ssh/known_hosts" -R [ipaddress]
```

清除本地保存的密钥,此时可以ssh或scp命令重新连接.

### tftp_install

- [software_install](#software_install)

TFTP的安装流程如下所示.

第一步，安装tftp应用需要的工具.

```shell
#安装xinetd服务
sudo apt-get install xinetd -y

#分别安装tftp客户端和服务器
sudo apt-get install tftp-hpa tftpd-hpa -y
```

第二步，修改配置文件.

其中xinetd的配置文件为 **/etc/xinetd.conf**, 可通过如下修改。

```shell
sudo vim /etc/xinetd.conf
```

内容修改为如下，如果已经存在则不需要修改.

```shell
# Simple configuration file for xinetd
#
# Some defaults, and include /etc/xinetd.d/

defaults
{

# Please note that you need a log_type line to be able to use log_on_success
# and log_on_failure. The default is the following :
# log_type = SYSLOG daemon info

}
includedir /etc/xinetd.d
```

下一步在xinetd.d目录下增加tftp的配置文件，配置文件为 **/etc/xinetd.d/tftp**, 通过如下方式修改。

```shell
sudo vim /etc/xinetd.d/tftp
```

内容修改如下所示, 其中server_args即指定tftp的目的地址。

```shell
server tftp
{
    socket_type = dgram
    wait = yes
    disable = no
    user = root
    protocol = udp
    server = /usr/sbin/in.tftpd
    server_args = -s /home/program/build/tftp_root/arm -c
    per_source = 11
    cps =100 2
    flags =IPv4
}
```

对于tftp的配置文件为 **/etc/default/tftpd-hpa**, 通过如下方式修改。

```shell
sudo vim /etc/default/tftpd-hpa
```

内容修改为如下所示。

```shell
# /etc/default/tftpd-hpa

TFTP_USERNAME="tftp"
#此处指定tftp的映射目录
TFTP_DIRECTORY="/home/program/build/tftp_root/arm"
TFTP_ADDRESS=":69"
TFTP_OPTIONS="--secure"
```

第三步, 通过service启动tftp服务器，执行命令如下.

```shell
sudo service tftpd-hpa restart
sudo service xinetd restart
```

如果此时测试服务器时否成功, 可创建任意文件到/home/program/build/tftp_root目录，本机通过tftp命令获取测试。

```shell
vim /home/program/build/tftp_root/test.c
#输入任意值保存

tftp 127.0.0.1 -c get test.c
```

查看本地是否由test.c文件，如果有表示启动成功。

### nfs_install

- [software_install](#software_install)

首先下载nfs服务器，具体命令如下。

```shell
sudo apt-get install nfs-kernel-server
```

配置nfs服务，具体对应文件/etc/exports.

```shell
sudo vim /etc/exports

#*表示允许所有网络段访问
#rw表示访问者具有读写权限
#sync表示同步缓存
#no_root_squash表示访问者为root权限
/home/program/build/nfs_root/arm *(rw,sync,no_root_squash)
```

之后重启nfs服务，并查看是否启动.

```shell
#重启nfs服务器
sudo /etc/init.d/nfs-kernel-server restart

#查看nfs服务器是否启动
showmount -e

#通过mount命令将nfs挂载到/home/nfs目录下，然后通过查看ls /home/nfs即可查看是否加载成功
#/home/nfs需要创建，并修改权限为r+w+x.
sudo mount -t nfs -o nolock,nfsvers=3 127.0.0.1:/home/program/build/nfs_root/arm /home/nfs
```

### vscode_install

- [software_install](#software_install)

vscode的官方下载地址为<https://code.visualstudio.com/#alt-downloads>。

选择Ubuntu版本，先在官网上点击下载，然后复制链接，将前面的路径替换成国内源vscode.cdn.azure.cn, 如果不清楚可以使用如下命令在linux上下载.

```shell
wget https://vscode.cdn.azure.cn/stable/1ad8d514439d5077d2b0b7ee64d2ce82a9308e5a/code_1.74.1-1671015296_amd64.deb
sudo dpkg -i code_1.74.1-1671015296_amd64.deb
```

安装完成后，输入code即可在linux上打开code，不过我喜欢添加vscode作为打开的link.

```shell
sudo ln -sf code /usr/bin/vscode
```

之后调用**vscode命令**即可打开vscode应用.

### node_install

- [software_install](#software_install)

node安装有两种方式，一种使用apt直接安装，这时会选择软件源中的对应node文件。

```shell
sudo apt-get install nodejs
sudo apt-get install npm
```

但这种方式安装的版本一般较低, 如果使用一些库或者开发用到js的新特性会失败, 这里建议直接去官网下载:<https://nodejs.org/en/download>, 选择最新的是LTS版本(这里最新的是20.9.0版本)即可，可通过如下命令下载, 这里列下常用版本的说明:

- Linux Binaries(x64):用于x86_64 linux访问的二进制文件, 也就是常说的PC端Linux环境node。
- Linux Binaries(ARM):用于ARM访问的二进制文件，其中ARMv7为老的32bit版本，ARMv8为新的64bit版本。
- Source Code:可以源码自己编译的版本

```shell
#进入软件安装目录
cd /home/program/download/install

#下载并解压
wget https://nodejs.org/dist/v20.9.0/node-v20.9.0-linux-x64.tar.xz
tar -xvf node-v20.9.0-linux-x64.tar.xz

#安装文件
sudo ln -sf /home/program/download/install/node-v20.9.0-linux-x64/bin/node /usr/bin/node
sudo ln -sf /home/program/download/install/node-v20.9.0-linux-x64/bin/npm /usr/bin/npm

#安装软件成功测试, v20.9.0
node -v
npm -v
```

### python_install

- [software_install](#software_install)

python的安装可以直接使用命令安装。

```shell
#安装python3和pip3
sudo apt-get install python3 pip3

#使用清华源安装python库
pip3 install [module] -i https://pypi.tuna.tsinghua.edu.cn/simple/
```

## next_chapter

[返回目录](./SUMMARY.md)

直接开始下一小节: [ch01-03.Linux shell脚本语法](./ch01-03.linux_shell_grammar.md)。
