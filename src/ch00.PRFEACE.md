# 前言

嵌入式Linux开发从技术上有两个大方向: 嵌入式Linux驱动开发和嵌入式Linux应用开发; 另外还有开发过程中维护可以运行整套应用的平台(虚拟机)。选择从哪个方向开始嵌入式Linux的学习，是每个开发者需要面对的问题。

- 嵌入式Linux应用开发是一门应用技术，主要通过程序在平台上实现具体的功能需求。除交叉编译(编译和执行平台不一致)，以及增加对底层硬件的访问外，和桌面端Linux开发基本一致。对于本身熟悉Linux桌面应用的开发者，入门相对简单，也很容易做出有成果的展示。另外这部分的例程和资源很多，例如实现web服务，QT方案，MQTT应用服务，都有成熟的开源方案。应用端根据平台的支持情况也会有更多语言的选择，如C/C++/python/qt(C++)/nodejs等。嵌入式Linux应用开发总结起来就是**方向多，学习曲线适中，方便快速入门**，很容易体验嵌入式Linux开发的兴趣。

- 嵌入式Linux驱动开发的方向则不同，不仅要理解soc的内核模块知识，后续的设备树，Linux内核接口，总线和设备驱动，每一部分都可以算难点；而即使掌握了这些技术，大部分情况下也只能开发并不复杂的设备驱动如gpio，i2c-dev，spi-dev等；对于复杂的cmos，net，hdmi，usb，pcie这类驱动，即使只修改适配不同的器件都困难重重。很多教程对于这些复杂驱动只展示menuconfig中如何启用模块，没有详细解释内部实现，其实这对于嵌入式Linux驱动过于简单。具体来说，这一步需要深入去学习Linux源码，理解执行流程，才能有一定建树，也可以说是嵌入式驱动开发中最枯燥，困难的部分；甚至找不到很好的学习资料，只能通过代码和调试去了解掌握，这方面的很多大牛也是以年为单位积累的，期望短时间内速成基本不可能。即使对于资深嵌入式驱动开发者也并不简单，对于初学者，则更容易从入门到放弃。

本文也是基于产品开发经验，从整体到局部来进行嵌入式Linux开发的讲解，是我在产品开发过程中的经验技术总结。整个系列按照功能包含。

1. Linux开发平台搭建
2. 软件安装及交叉编译
3. shell脚本和Kconfig语法
4. uboot，kernel，文件系统编译构建
5. 驱动开发接口和实现
6. 嵌入式Linux应用接口和应用开发。

嵌入式Linux开发总体来说是服务产品的技术，无论学习什么知识，最终都要落实到具体的产品中，如何学以致用才是最重要的。本系列文档除了自带的测试目录，也有配合的开发项目同步进行实践，具体如下。

- git clone <https://github.com/zc110747/remote_manage.git>

对于涉及嵌入式Linux开发应用的产品中，往往也不是单独的嵌入式Linux端设备, 可能还有协调了多个基于单片机或DSP开发的子系统，以及上层PC或服务器平台，下面展示典型的嵌入式项目产品架构。

- PC客户端/web端/移动端 - 云端(可选) - 嵌入式linux端 - DSP/MCU/FPGA端

其中嵌入式Linux开发部分主要实现以下功能(可选)。

1. 支持稳定运行的系统平台，包含uboot，内核和文件系统的功能实现。
2. 用于支持本地应用执行的硬件驱动的开发，如gpio, i2c, spi，hdmi，net，rs485, can这类驱动。
3. 用于支持本地应用执行库的移植，如libssl.so, libcrypto.so等。
4. 提供本地调试或者客户端功能的第三方应用，如vnc, ssh等。
5. 支持管理子设备(包含DSP，MCU，FPGA等)的应用实现，包含不限于:接口驱动、通讯协议，数据管理和应用。
6. 提供一套UI界面用于本地界面控制或者信息展示(基于QT, LVGL, Android UI的应用)。
7. 局域网访问和管理的服务器，包括不限于http, telnet, snmp协议支持。
8. 支持远程访问和管理的网络客户端，如mqtt subcribe/publisher, tcp客户端等。

这里显示一款基于嵌入式Linux构建的应用产品框架。

![image](image/mainFrame.png)

对于嵌入式linux开发人员来说，工作主要涉及如下内容.

1. 建立支持开发的环境

    - 包括不限于Linux的安装，编译工具的支持(gcc, Makefile), 相应库和工具的安装，实现快速构建的脚本。

2. 实现稳定的嵌入式linux运行平台

    - 包括uboot，kernal和文件系统的完善支持，包含嵌入式linux系统的bringup工作，这里涉及设备树和驱动的修改，menuconfig配置，以及编译和下载的流程，这一步主要适配RAM，ROM, 内核，时钟频率以及必要串口的改动，高端的要适配pcie等接口，完成这一步就可以系统就可以正常运行，显示和打印输出。

3. 嵌入式linux驱动的开发

    - 实现产品运行需要支持硬件驱动，包括不限于I2C，SPI, RS485, CAN等，芯片厂商会提供芯片硬件访问的接口，开发者将其则与Linux内核结合起来，实现嵌入式linux驱动开发。

4. 嵌入式linux应用开发

    - 嵌入式linux应用开发可以理解为支持硬件接口访问的Linux应用开发，如果实现相应的库和运行环境，可以支持使用c/c++, python，nodejs等进行开发。不过语言只是手段，在之上构建的包含网络，UI，数据管理，子系统管理，调试和日志接口才是应用开发的的重点。Linux应用开发主要包含自己实现部分和开源代码集成部分，如果能妥善的使用开源项目，可以大幅度提升开发效率。

本系列从框架也按照上述章节顺序去讲解，不过从学习的角度，不宜按照此顺序去学习。例如第2章所需要的基础知识是需要在第1，3，4章去了解的。虽然学深入了，这4章节难度上不分上下。但从学习曲线来说，从易到难排列为**第1章=>第3章=>第4章=>第2章**。所以学习时也建议先从已经构建好的平台(如国产的各类开源派或开发板已经构建完整的系统)，从应用开始，可以快速体验Linux平台开发的乐趣，然后从驱动入手，再通过shell脚本，最终按照自己的习惯构建自己的开发平台。

对于嵌入式Linux开发来说，另一个重要的就是选择合适的芯片来开始学习。开发环境是在芯片选型后确定的。项目开发立项后，一般会使用指定开发板作为项目验证原型板；目前工业板卡厂商，方案商和培训机构都会提供硬件原理图，编译开发环境，文档和技术支持服务。在此基础上开发可以大幅度提高效率，节省大量时间，这里展示目前市面上我了解的提供完整嵌入式Linux软硬件方案商，主要有以下几类:
的厂

- 培训教学机构，如韦东山，正点原子等，提供资料丰富，知识面广，而且资料开源做的很好，适合入门选择，缺点是资料更新一般很慢，在有完整的运行方案的，很少有动力去更新适配最新的版本，适合希望入门或者刚入行的新人购买。
- 专业的板卡方案商，如讯为，飞凌，米尔科技等，提供全套使用的方案，定制服务，不过资料会限制，不适合用于学习，但是平台一般都经过全套的认证，适合直接用于产品开发，一般作为公司的产品需求购买，对于个人开发者是不利的。
- 芯片厂商的验证板，如NXP(I.MX6ull-evk), Ti(TMDSIDK574), 这一般叫做原型板，优点厂商会提供基于此硬件的全套平台方案(包含U-boot, Kernel和rootfs)，不过价格昂贵，且官方开发板展示的是厂商主推功能，不一定考虑应用的需求，另外非重要客户，如果遇到问题基本只能论坛等待解决。一般都是企业或者方案商按需购买，个人很少会采用。
- 卡片电脑设备商，这一类以树莓派为代表，国内的有香橙派，核桃派等，特们的特点是使用高性能的芯片(以多核Cortex-A53, Cortex-A72)为主，提供全套的系统安装包，应用集成python，g++等环境，可以以电脑的方式操作嵌入式硬件。开发简单，适合体验嵌入式应用开发，不过用于学习嵌入式Linux驱动的话资料较少，另外可靠性也很难保证，且性能往往过剩，不适合用于产品中。这类卡片可以用来学习适应Linux环境，折腾嵌入式应用开发，无论入门还是资深开发者都可以购买。

当然，如果有动手能力，也可以参考上述的硬件资料，自己设计开发板，这就是嵌入式硬件的范畴，不在本文档的说明之内。另外上述虽然提到了一些厂商，只是因为购买或了解过，并不表示认可，如果真有需求，建议还是进一步收集资料后再选择，毕竟花钱是一方面，浪费时间在不合适的平台上，则更加严重。

## next_chapter

[返回目录](./SUMMARY.md)

下面开始第1章节的学习:[ch01.构建Linux开发平台环境](./ch01-00.platform_env_struct.md)
