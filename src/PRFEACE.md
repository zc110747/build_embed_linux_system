# 前言

嵌入式linux开发从技术上有两个大方向, 嵌入式Linux驱动开发和嵌入式Linux应用开发，当然还有在这两部分执行的基础，嵌入式系统平台构建。这是每个想学习嵌入式Linux开发者最初需要面对的问题.嵌入式应用开发除了交叉编译的区别以及增加对底层硬件的访问，和Linux平台并没有太大差异，入门相对简单，而且也很容易做出有成果的产品，例如实现web服务，gui界面，mqtt服务，开发后都可以直接展示出来，而且应用端根据平台的支持情况也会有更多语言的选择，如C/C++/qt/nodejs/java等，可以体验嵌入式学习的乐趣。驱动开发的方向则不同，就算有芯片硬件基础，也掌握了内核API接口，熟悉设备树/设备树访问匹配的机制，可以完成设备创建，以及构建一套能够执行加载驱动的uboot和内核(大部分开发板讲述的内容)，也就只能直接开发简单的外设驱动如gpio，i2c, spi等；对于cmos，net，hdmi, can， pcie, usb这类驱动(内核包含，不用重新开发)，如何修改适配不同的器件仍然困难重重，如果只是在menuconfig中启用某个外设模块, 对于嵌入式Linux驱动的学习基本没啥意义，这一步就需要取深入学习Linux源码中的相关文件，这部分就是嵌入式Linux最枯燥，困难的部分，甚至找不到很好的学习资料，只能硬啃代码，即使对于资深嵌入式驱动开发者也并不简单，如果是初学者者，以这个方法入门，很容易从入门到放弃。

本文也是基于嵌入式Linux产品开发的经验，以整体方案来进行嵌入式Linux开发的说明，其中也包含我在开发过程中所涉及到技术总结，不仅仅只是应用。项目包含开发中用到的linux开发环境构建，软件安装，shell脚本创建，uboot和kernal编译中的语法，驱动开发，应用框架，应用接口和应用开发用于支持快速构建，编译和运行的方法。嵌入式linux开发是一门产品开发的技术，因此如何结合应用去学习才是最重要的，因此本文档也有配合的开发项目同步进行实践，对于项目的地址如下

- git clone <https://github.com/zc110747/remote_manage.git>

对于涉及嵌入式linux开发应用的产品中，往往也不是只有一个嵌入式linux端设备, 可能还有协调了多块硬件板，作为嵌入式端的主控来共同构成功能，下面展示典型的嵌入式项目产品架构.

- PC客户端/web端/移动端 - 云端(可选) - 嵌入式linux端 - DSP/MCU/FPGA端

其中嵌入式linux开发部分主要实现以下功能(可选，并非全部都是).

1. 支持稳定运行的系统平台，包含uboot，内核和文件系统的功能实现。
2. 用于支持本地应用执行的硬件驱动的开发或适配，如gpio, i2c, spi，hdmi，net，rs485, can这类驱动.
3. 用于支持本地应用执行的lib和相关软件的编译移植，如libssl.so, libcrypto.so, openssh，vnc, mosquitto等.
4. 支持管理子设备(包含DSP，MCU，FPGA等)的应用实现，接口驱动、通讯协议，数据管理和应用实现.
5. 提供一套UI界面用于本地界面控制或者信息展示(QT, Android App应用).
6. 局域网访问和管理的服务器，包括不限于http, snmp协议支持.
7. 支持远程访问和管理的网络客户端，如mqtt subcribe/publisher, tcp客户端等

这里展示上面项目对应的一个嵌入式Linux的产品框架，包含完整的上述服务和实现。

![image](image/mainFrame.png)

对于嵌入式linux开发人员来说，工作就可能涉及如下内容.

1. 建立支持开发的环境

    - 包括不限于linux的安装，编译工具的支持(gcc, makefile), 相应库和工具的安装.

2. 实现稳定的嵌入式linux运行平台

    - 包括uboot，kernal和文件系统的完善支持，包含嵌入式linux系统的bringup工作，这里涉及设备树和驱动的修改，menuconfig配置，以及编译和下载的流程，这一步主要适配RAM，ROM, 内核，时钟频率以及必要串口的改动，高端的要适配pcie等接口，完成这一步就可以系统就可以正常运行，显示和打印输出.

3. 嵌入式linux驱动的开发

    - 实现产品运行需要支持硬件驱动，包括不限于i2c, spi, dcmi, rs485, can等，芯片厂商会提供芯片硬件访问的接口，开发者将其则与linux内核接口结合起来，实现嵌入式linux驱动模块.

4. 嵌入式linux应用开发

    - 嵌入式linux应用开发可以理解为支持硬件接口访问的linux应用开发，如果实现相应的库和运行环境，可以支持使用c/c++, python，node，rust，lua，Android/Java, QT/C++等进行开发，如果是Ubuntu，Debian或Android系统，则基本和linux开发一致.不过语言只是手段，在之上构建的包含网络，UI，数据管理，子系统管理，调试和日志接口才是应用开发的的重点，这里面一部分需要自己实现，另一部分可以由开源的代码以源码或者库的方式参与，选择合适的平台和代码组合，以大幅度提升效率的.

本文也按照上述顺序去讲解，不过从学习的角度，不宜按照此顺序去学习，因为二部分所需要的很多知识是可以在第一，三，四阶段去了解的，虽然学深入了，这四部分各有难度，不分上下。但从入门友好来说，特别是本身熟悉编译语言如C/C++的来说，可以排列为4>1>3>2, 所以学习时也建议先从已经构建好的平台(如国产的各类开源派，或者开发板构建完整的系统)，**从应用开始，可以快速体验Linux平台开发的乐趣，然后从驱动入手，再配合逐渐熟悉的shell语法，最终构建一套属于自己的开发平台**。当然本文也适合有一定基础，但不知道如何提升自己的嵌入式Linux开发者，这里会深入总结嵌入式Linux相关的技术，以一个产品为范例，描述涉及所有的技术，如果能够系统学习下来，对嵌入式Linux会有比较深入的认知。
