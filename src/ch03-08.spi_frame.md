# spi设备和驱动管理框架

SPI是一种高速，高效率的串行接口技术，通常由一个主模块和一个或多个从模块构成。主要用于芯片和芯片，芯片和器件之间的数据传输通讯。

SPI设计上为主从结构，在工作时通过主机提供时钟触发信号，发送数据的同时从接收引脚上读取数据，同时实现数据接收和发送功能，因此为全双工模式。SPI设计上没有类似I2C的地址来区分从机设备，对于多从机的通讯，需要依赖CS引脚来选中芯片工作。当SPI总线上有多个芯片使能，写入不影响，但多从机读取时会发生总线竞争，有可能导致接收数据异常。当管理多个器件时，设计上需要每个芯片拥有独立的片选控制CS引脚。

- 片选CS，芯片使能控制脚，低电平有效居多，当CS为高时芯片不工作，可通过多个CS脚，控制芯片的开关从而实现SPI访问多个外部芯片
- 时钟CLK，时钟引脚，由主机发出，为主从机通讯提供同步时钟
- 主机输出接口(MOSI)，主机数据输出脚，配合Clock同步发出数据，从机接收
- 主机输入接口(MISO)，主机数据输入脚，根据Clock接收数据，从机发送

## spi硬件和驱动模型



spi中cs-gpios指定片选，和下面reg对应，reg为0表示第一个片选，reg为1表示第二个片选，依次递推。

## next_chapter

[返回目录](../README.md)

直接开始下一节说明: [iio子系统](./ch03-09.iio_subsystem.md)
